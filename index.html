<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Class Schedule</title>
  <style>
    body {
      font-family: "Poppins", sans-serif;
      margin: 0;
      padding: 0;
      background-color: #121212;
      color: #fff;
      transition: background-color 0.3s, color 0.3s;
    }
    header {
      background-color: #1f1f1f;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }
    header h1 {
      margin: 0;
      font-size: 1.5rem;
    }
    .view-buttons, .control-buttons {
      display: flex;
      gap: 10px;
    }
    button {
      background-color: #0078ff;
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: background-color 0.3s;
    }
    button:hover { background-color: #005ec7; }
    #content { padding: 20px; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      background-color: #1c1c1c;
      border-radius: 10px;
      overflow: hidden;
    }
    th, td {
      border: 1px solid #333;
      padding: 10px;
      text-align: left;
    }
    th {
      background-color: #2a2a2a;
      font-weight: 600;
    }
    .btn-delete {
      background-color: #ff3b3b;
    }
    .btn-delete:hover {
      background-color: #d63030;
    }
    #modal, #importModal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    #modal-content, #importModalContent {
      background-color: #1e1e1e;
      padding: 20px;
      border-radius: 10px;
      width: 320px;
    }
    input, select, textarea {
      width: 100%;
      padding: 8px;
      margin: 8px 0;
      border: none;
      border-radius: 6px;
    }
    textarea {
      height: 150px;
      resize: none;
    }
    .dark-mode {
      background-color: #fff;
      color: #000;
    }
    .dark-mode header { background-color: #f4f4f4; color: #000; }
    .dark-mode table { background-color: #fafafa; color: #000; }
    .dark-mode th { background-color: #ddd; }
    .dark-mode td, .dark-mode th { border: 1px solid #ccc; }
  </style>
</head>
<body>
  <header>
    <h1>📘 Class Schedule</h1>
    <div class="view-buttons">
      <button id="tableViewBtn">Table View</button>
      <button id="workflowViewBtn">Workflow</button>
      <button id="coursesViewBtn">Courses</button>
    </div>
    <div class="control-buttons">
      <button id="addClassBtn">Add Class</button>
      <button id="exportBtn">Export</button>
      <button id="importBtn">Import</button>
      <button id="clearBtn">Clear</button>
      <button id="themeToggleBtn">🌙</button>
    </div>
  </header>

  <div id="content"></div>

  <!-- Add Class Modal -->
  <div id="modal">
    <div id="modal-content">
      <h2>Add Class</h2>
      <form id="addClassForm">
        <label for="day">Day</label>
        <select id="day" required>
          <option value="">Select Day</option>
          <option>Monday</option>
          <option>Tuesday</option>
          <option>Wednesday</option>
          <option>Thursday</option>
          <option>Friday</option>
          <option>Saturday</option>
          <option>Sunday</option>
        </select>
        <label for="time">Time</label>
        <input type="time" id="time" required />
        <label for="class">Class Name</label>
        <input type="text" id="class" placeholder="Enter class name" required />
        <label for="room">Room</label>
        <input type="text" id="room" placeholder="Enter room" />
        <label for="course">Course</label>
        <input type="text" id="course" placeholder="Enter course name" />
        <div style="display:flex; justify-content:space-between; margin-top:10px;">
          <button type="submit">Add</button>
          <button type="button" id="cancelBtn">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Import JSON Modal -->
  <div id="importModal">
    <div id="importModalContent">
      <h2>Import JSON Data</h2>
      <textarea id="importTextarea" placeholder='Paste JSON data here...'></textarea>
      <div style="display:flex; justify-content:space-between; margin-top:10px;">
        <button id="importConfirmBtn">Import</button>
        <button id="importCancelBtn">Cancel</button>
      </div>
    </div>
  </div>

  <script>
    // ---------- Local Storage ----------
    let scheduleData = JSON.parse(localStorage.getItem("scheduleData")) || [];
    function saveData() {
      localStorage.setItem("scheduleData", JSON.stringify(scheduleData));
    }

    // ---------- View Buttons ----------
    const content = document.getElementById("content");
    document.getElementById("tableViewBtn").addEventListener("click", renderTableView);
    document.getElementById("workflowViewBtn").addEventListener("click", renderWorkflowView);
    document.getElementById("coursesViewBtn").addEventListener("click", renderCoursesView);

    // ---------- Render Functions ----------
    function renderTableView() {
      const data = [...scheduleData].sort((a, b) => {
        const days = ["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];
        const getTime = (t) => parseInt(t.replace(":", ""));
        return days.indexOf(a.day) - days.indexOf(b.day) || getTime(a.time) - getTime(b.time);
      });

      let html = `
        <table>
          <thead>
            <tr>
              <th>Day</th>
              <th>Time</th>
              <th>Class</th>
              <th>Room</th>
              <th>Course</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
      `;
      if (data.length === 0) {
        html += `<tr><td colspan="6">No classes scheduled.</td></tr>`;
      } else {
        data.forEach((item, index) => {
          html += `
            <tr>
              <td>${item.day}</td>
              <td>${item.time}</td>
              <td>${item.className}</td>
              <td>${item.room}</td>
              <td>${item.course}</td>
              <td><button class="btn-delete" data-index="${index}">Delete</button></td>
            </tr>
          `;
        });
      }
      html += `</tbody></table>`;
      content.innerHTML = html;

      document.querySelectorAll(".btn-delete").forEach(btn => {
        btn.addEventListener("click", e => {
          const idx = e.target.dataset.index;
          scheduleData.splice(idx, 1);
          saveData();
          renderTableView();
        });
      });

      highlightToday();
    }

    function renderWorkflowView() {
      content.innerHTML = `
        <h2>Workflow Summary</h2>
        <ul>
          ${scheduleData.map(d => `<li>${d.day} - ${d.time} (${d.className})</li>`).join("") || "<li>No classes yet.</li>"}
        </ul>
      `;
    }

    function renderCoursesView() {
      const courses = [...new Set(scheduleData.map(d => d.course))];
      content.innerHTML = `
        <h2>Courses</h2>
        <ul>${courses.length ? courses.map(c => `<li>${c}</li>`).join("") : "<li>No courses added.</li>"}</ul>
      `;
    }

    // ---------- Add Class Modal ----------
    const modal = document.getElementById("modal");
    const addClassBtn = document.getElementById("addClassBtn");
    const cancelBtn = document.getElementById("cancelBtn");
    const addClassForm = document.getElementById("addClassForm");
    addClassBtn.addEventListener("click", () => modal.style.display = "flex");
    cancelBtn.addEventListener("click", () => modal.style.display = "none");
    window.addEventListener("click", e => { if (e.target === modal) modal.style.display = "none"; });

    addClassForm.addEventListener("submit", e => {
      e.preventDefault();
      const newClass = {
        day: document.getElementById("day").value,
        time: document.getElementById("time").value,
        className: document.getElementById("class").value,
        room: document.getElementById("room").value,
        course: document.getElementById("course").value,
      };
      scheduleData.push(newClass);
      saveData();
      modal.style.display = "none";
      addClassForm.reset();
      renderTableView();
    });

    // ---------- Export ----------
    document.getElementById("exportBtn").addEventListener("click", () => {
      const blob = new Blob([JSON.stringify(scheduleData, null, 2)], { type: "application/json" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "scheduleData.json";
      a.click();
    });

    // ---------- Import (Paste JSON) ----------
    const importModal = document.getElementById("importModal");
    const importBtn = document.getElementById("importBtn");
    const importConfirmBtn = document.getElementById("importConfirmBtn");
    const importCancelBtn = document.getElementById("importCancelBtn");
    const importTextarea = document.getElementById("importTextarea");

    importBtn.addEventListener("click", () => {
      importModal.style.display = "flex";
      importTextarea.value = "";
    });
    importCancelBtn.addEventListener("click", () => importModal.style.display = "none");

    importConfirmBtn.addEventListener("click", () => {
      try {
        const parsed = JSON.parse(importTextarea.value.trim());
        if (Array.isArray(parsed)) {
          scheduleData = parsed;
          saveData();
          renderTableView();
          importModal.style.display = "none";
        } else {
          alert("JSON must be an array of class objects.");
        }
      } catch (err) {
        alert("Invalid JSON format. Please check and try again.");
      }
    });

    // ---------- Clear ----------
    document.getElementById("clearBtn").addEventListener("click", () => {
      if (confirm("Are you sure you want to clear all data?")) {
        scheduleData = [];
        saveData();
        renderTableView();
      }
    });

    // ---------- Highlight Today ----------
    function highlightToday() {
      const today = new Date().toLocaleString("en-AU", { weekday: "long" });
      document.querySelectorAll("table tbody tr").forEach(row => {
        const dayCell = row.children[0];
        if (dayCell && dayCell.textContent === today) {
          row.style.backgroundColor = "rgba(0,255,0,0.15)";
        }
      });
    }

    // ---------- Dark Mode ----------
    const themeToggleBtn = document.getElementById("themeToggleBtn");
    themeToggleBtn.addEventListener("click", () => {
      document.body.classList.toggle("dark-mode");
      themeToggleBtn.textContent = document.body.classList.contains("dark-mode") ? "☀️" : "🌙";
    });

    // ---------- Initial Render ----------
    renderTableView();
  </script>
</body>
</html>
